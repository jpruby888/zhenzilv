"use strict";var e=require("../../common/vendor.js"),o=require("../../utils/commonUtils.js");if(!Array){e.resolveComponent("RecordList")()}Math;const r={__name:"record",setup(r){const s=e.reactive({user:{},records:[]}),c=e.ref(!1);let n=0,t=!0,a=!1;const l=async r=>{e.index.showLoading({title:"加载中..."}),r&&(n=1,t=!0),1===n&&(s.records=[],console.log("state.records",s.records));const l={openid:s.user._id?s.user._id:"",_currentPage:n,_pageSize:15},d=await o.callCloudFunction("zhenzilv","getRecords",l).catch((r=>{o.showModel("出现问题了","请联系管理员"),e.index.hideLoading()}));e.index.hideLoading(),console.log(d),a&&(e.index.stopPullDownRefresh(),a=!1),s.records=s.records.concat(d.result.data),t=d.result.hasMore,0===s.records.length?c.value=!0:c.value=!1,console.log("state.records: ",s.records)};return e.onShow((()=>{const o=JSON.parse(e.index.getStorageSync("user")||null);o?(s.user=o,console.log(s.user),l(!0),c.value=!1,t=!0):(c.value=!0,t=!1)})),e.onShareAppMessage((()=>({title:"真自律",path:"/pages/record/record"}))),e.onReachBottom((()=>{t&&(n+=1,console.log("当前在第几页",n),l())})),e.onPullDownRefresh((()=>{a=!0,l(!0)})),(o,r)=>e.e({a:c.value},c.value?{}:e.e({b:e.f(s.records,((o,r,s)=>({a:r,b:"48804321-0-"+s,c:e.p({record:o})}))),c:!e.unref(t)},(e.unref(t),{})))}};var s=e._export_sfc(r,[["__scopeId","data-v-48804321"]]);r.__runtimeHooks=2,wx.createPage(s);
